Изменения существующих моделей (только дополнения)
1) Goal — новые поля
Код (примерно):
# Goal (новые поля)
trainer_id: int | None
trainer_gender: str | None
plan_constraints: dict | None    # JSON с ограничениями
Зачем:
trainer_id — хранит выбранного тренера для цели
trainer_gender — пол тренера (для ассетов и грамматики)
plan_constraints — ограничения, которые вводит пользователь (JSON)
Шаблон JSON для plan_constraints:
{
  "hours_per_day": 5,
  "days_per_week": 5,
  "time_window": { "start": "12:00", "end": "17:00" },
  "exclude_holidays": true,
  "workdays_only": true,
  "deadline": "2025-03-01",
  "plan_intensity": "medium",
  "plan_flexibility": "strict"
}
2) User — новые поля
Код (примерно):
# User (новые поля)
default_trainer_id: int | None
default_trainer_gender: str | None
Зачем:
хранить тренера по умолчанию для новых целей

3) Milestone — версия плана
Код (примерно):
# Milestone (новое поле)
plan_version: str  # "current" | "previous"
Зачем:
хранить текущий и предыдущий план (MVP)
4) Task — версия плана
Код (примерно):
# Task (новое поле)
plan_version: str  # "current" | "previous"
Зачем:
задачи должны соответствовать версии плана, иначе будет путаница

Обновление промпта (новый промпт целиком)
Ниже — полный шаблон нового промпта с заглушками.
Это не финальные значения, а структура для внедрения.
Ты — персональный коуч. Твой стиль: {trainer_tone}.
{trainer_rules}
Ты — {trainer_gender}, используй соответствующие формы речи.

ПЛАН (требования пользователя):
- Цель: "{goal_title}"
- Ограничения: {plan_constraints}
- Интенсивность: {plan_intensity}

ТОН ТРЕНЕРА:
- Стиль: {trainer_tone}
- Речь: {trainer_speech_rules}
- Запрещено: {trainer_stop_words}

ВАЖНО: План формирует AI на основе требований пользователя. Ты можешь предложить изменения, но не меняешь план без согласия.

ФОРМАТ ОТВЕТА — JSON в одну строку:
{"message":"твой текст","actions":[]}


Что изменилось и зачем
1) Добавлены блоки “ПЛАН” и “ТОН”
— чтобы разделить требования пользователя и стиль тренера.
2) Добавлены заглушки полей ({trainer_*}, {plan_*})
— значения будут браться из БД (профиль тренера + JSON ограничений).
3) Исправлена формулировка про план
— “План формирует AI на основе требований пользователя”.
Заглушки (что подставлять)
{trainer_tone} — стиль тренера (gentle/normal/strict)
{trainer_rules} — правила речи тренера
{trainer_gender} — пол тренера
{trainer_speech_rules} — краткие правила речи
{trainer_stop_words} — список запретных слов
{goal_title} — название цели
{plan_constraints} — JSON ограничений
{plan_intensity} — легкий/средний/тяжелый

Update — дневное окно уведомлений (User)
Контекст:
Чтобы не отправлять уведомления ночью, вводим дневное окно активности пользователя. Это нужно для всех тренеров и типов уведомлений.
Изменения в модели User
Код (примерно):
# User (новые поля)
notification_window_start: str | None  # например "09:00"
notification_window_end: str | None    # например "21:00"

Зачем это нужно
Ограничиваем отправку уведомлений дневным временем
Уважение к личному времени пользователя
Единое правило для всех типов напоминаний
Как использовать
Все уведомления (успех / провал / мотивация) отправляются только в пределах окна
Если окно не задано — используется дефолт (например 09:00–21:00)

Изменения существующих моделей (только дополнения)
1) Goal — новые поля
Код (примерно):
# Goal (новые поля)
trainer_id: int | None
trainer_gender: str | None
plan_constraints: dict | None    # JSON с ограничениями
Зачем:
trainer_id — хранит выбранного тренера для цели
trainer_gender — пол тренера (для ассетов и грамматики)
plan_constraints — ограничения, которые вводит пользователь (JSON)
Шаблон JSON для plan_constraints:
{
  "hours_per_day": 5,
  "days_per_week": 5,
  "time_window": { "start": "12:00", "end": "17:00" },
  "exclude_holidays": true,
  "workdays_only": true,
  "deadline": "2025-03-01",
  "plan_intensity": "medium",
  "plan_flexibility": "strict"
}
2) User — новые поля
Код (примерно):
# User (новые поля)
default_trainer_id: int | None
default_trainer_gender: str | None
Зачем:
хранить тренера по умолчанию для новых целей

3) Milestone — версия плана
Код (примерно):
# Milestone (новое поле)
plan_version: str  # "current" | "previous"
Зачем:
хранить текущий и предыдущий план (MVP)
4) Task — версия плана
Код (примерно):
# Task (новое поле)
plan_version: str  # "current" | "previous"
Зачем:
задачи должны соответствовать версии плана, иначе будет путаница

Обновление промпта (новый промпт целиком)
Ниже — полный шаблон нового промпта с заглушками.
Это не финальные значения, а структура для внедрения.
Ты — персональный коуч. Твой стиль: {trainer_tone}.
{trainer_rules}
Ты — {trainer_gender}, используй соответствующие формы речи.

ПЛАН (требования пользователя):
- Цель: "{goal_title}"
- Ограничения: {plan_constraints}
- Интенсивность: {plan_intensity}

ТОН ТРЕНЕРА:
- Стиль: {trainer_tone}
- Речь: {trainer_speech_rules}
- Запрещено: {trainer_stop_words}

ВАЖНО: План формирует AI на основе требований пользователя. Ты можешь предложить изменения, но не меняешь план без согласия.

ФОРМАТ ОТВЕТА — JSON в одну строку:
{"message":"твой текст","actions":[]}


Что изменилось и зачем
1) Добавлены блоки “ПЛАН” и “ТОН”
— чтобы разделить требования пользователя и стиль тренера.
2) Добавлены заглушки полей ({trainer_*}, {plan_*})
— значения будут браться из БД (профиль тренера + JSON ограничений).
3) Исправлена формулировка про план
— “План формирует AI на основе требований пользователя”.
Заглушки (что подставлять)
{trainer_tone} — стиль тренера (gentle/normal/strict)
{trainer_rules} — правила речи тренера
{trainer_gender} — пол тренера
{trainer_speech_rules} — краткие правила речи
{trainer_stop_words} — список запретных слов
{goal_title} — название цели
{plan_constraints} — JSON ограничений
{plan_intensity} — легкий/средний/тяжелый

Update — дневное окно уведомлений (User)
Контекст:
Чтобы не отправлять уведомления ночью, вводим дневное окно активности пользователя. Это нужно для всех тренеров и типов уведомлений.
Изменения в модели User
Код (примерно):
# User (новые поля)
notification_window_start: str | None  # например "09:00"
notification_window_end: str | None    # например "21:00"

Зачем это нужно
Ограничиваем отправку уведомлений дневным временем
Уважение к личному времени пользователя
Единое правило для всех типов напоминаний
Как использовать
Все уведомления (успех / провал / мотивация) отправляются только в пределах окна
Если окно не задано — используется дефолт (например 09:00–21:00)

